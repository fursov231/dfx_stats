{"ast":null,"code":"import axios from 'axios';\n/*\r\n    /api/compound/governance\r\n    Returns data about COMP holders\r\n    and governance proposals\r\n*/\n\nexport default ((req, res) => {\n  return new Promise(resolve => {\n    // Pull top 100 COMP holders\n    axios.get(\"https://api.compound.finance/api/v2/governance/accounts?page_size=100&page_number=1&with_history=false&network=mainnet\").then(compaddr => {\n      // Pull Compound governance proposals\n      axios.get(\"https://api.compound.finance/api/v2/governance/proposals\").then(gov => {\n        // Pull COMP price\n        axios.get(\"https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=compound-governance-token\").then(comp => {\n          let comp_holders = compaddr.data.accounts; // Fix error with user 'Can Not Lose''s profile picture\n\n          for (let i = 0; i < comp_holders.length; i++) {\n            if (comp_holders[i].display_name === 'Can Not Lose') {\n              comp_holders[i].image_url = '';\n            }\n          } // Return response object\n\n\n          let response = {\n            \"addresses\": compaddr.data.accounts,\n            \"proposals\": gov.data.proposals,\n            \"current_price\": comp.data[0].current_price\n          };\n          res.send(response);\n          res.status(200).end();\n          resolve();\n        });\n      });\n    });\n  });\n});","map":{"version":3,"sources":["C:/Users/furso/Desktop/stat.farm/pages/api/compound/governance.js"],"names":["axios","req","res","Promise","resolve","get","then","compaddr","gov","comp","comp_holders","data","accounts","i","length","display_name","image_url","response","proposals","current_price","send","status","end"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA;AACA;AACA;AACA;AACA;;AAEA,gBAAe,CAACC,GAAD,EAAMC,GAAN,KAAc;AACzB,SAAO,IAAIC,OAAJ,CAAYC,OAAO,IAAI;AAC1B;AACAJ,IAAAA,KAAK,CAACK,GAAN,CAAU,wHAAV,EAAoIC,IAApI,CAAyIC,QAAQ,IAAI;AACjJ;AACAP,MAAAA,KAAK,CAACK,GAAN,CAAU,0DAAV,EAAsEC,IAAtE,CAA2EE,GAAG,IAAI;AAC9E;AACAR,QAAAA,KAAK,CAACK,GAAN,CAAU,8FAAV,EAA0GC,IAA1G,CAA+GG,IAAI,IAAI;AACnH,cAAIC,YAAY,GAAGH,QAAQ,CAACI,IAAT,CAAcC,QAAjC,CADmH,CAGnH;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,YAAY,CAACI,MAAjC,EAAyCD,CAAC,EAA1C,EAA8C;AAC1C,gBAAIH,YAAY,CAACG,CAAD,CAAZ,CAAgBE,YAAhB,KAAiC,cAArC,EAAqD;AACjDL,cAAAA,YAAY,CAACG,CAAD,CAAZ,CAAgBG,SAAhB,GAA4B,EAA5B;AACH;AACJ,WARkH,CAUnH;;;AACA,cAAIC,QAAQ,GAAG;AACX,yBAAaV,QAAQ,CAACI,IAAT,CAAcC,QADhB;AAEX,yBAAaJ,GAAG,CAACG,IAAJ,CAASO,SAFX;AAGX,6BAAiBT,IAAI,CAACE,IAAL,CAAU,CAAV,EAAaQ;AAHnB,WAAf;AAMAjB,UAAAA,GAAG,CAACkB,IAAJ,CAASH,QAAT;AACAf,UAAAA,GAAG,CAACmB,MAAJ,CAAW,GAAX,EAAgBC,GAAhB;AACAlB,UAAAA,OAAO;AACV,SApBD;AAqBH,OAvBD;AAwBH,KA1BD;AA2BH,GA7BM,CAAP;AA8BH,CA/BD","sourcesContent":["import axios from 'axios'\r\n\r\n/*\r\n    /api/compound/governance\r\n    Returns data about COMP holders\r\n    and governance proposals\r\n*/\r\n\r\nexport default (req, res) => {\r\n    return new Promise(resolve => {\r\n        // Pull top 100 COMP holders\r\n        axios.get(\"https://api.compound.finance/api/v2/governance/accounts?page_size=100&page_number=1&with_history=false&network=mainnet\").then(compaddr => {\r\n            // Pull Compound governance proposals\r\n            axios.get(\"https://api.compound.finance/api/v2/governance/proposals\").then(gov => {\r\n                // Pull COMP price\r\n                axios.get(\"https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=compound-governance-token\").then(comp => {\r\n                    let comp_holders = compaddr.data.accounts;\r\n                    \r\n                    // Fix error with user 'Can Not Lose''s profile picture\r\n                    for (let i = 0; i < comp_holders.length; i++) {\r\n                        if (comp_holders[i].display_name === 'Can Not Lose') {\r\n                            comp_holders[i].image_url = '';\r\n                        }\r\n                    }\r\n                    \r\n                    // Return response object\r\n                    let response = {\r\n                        \"addresses\": compaddr.data.accounts,\r\n                        \"proposals\": gov.data.proposals,\r\n                        \"current_price\": comp.data[0].current_price\r\n                    }\r\n\r\n                    res.send(response);\r\n                    res.status(200).end();\r\n                    resolve();\r\n                })\r\n            })\r\n        })\r\n    })\r\n}\r\n"]},"metadata":{},"sourceType":"module"}